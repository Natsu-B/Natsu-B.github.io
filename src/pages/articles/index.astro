---
import ArticleCard from "../../components/ArticleCard.astro";
import TagChips from "../../components/TagChips.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getPublishedArticles, getTagSummaries } from "../../lib/articles";

const articles = await getPublishedArticles();
const tags = getTagSummaries(articles);
---

<BaseLayout
  title="Articles | ほたるいか"
  description="技術記事の一覧ページ。タイトル、日付、概要、タグから探せます。"
>
  <section class="panel px-6 py-6 sm:px-8 sm:py-8">
    <h1 class="text-2xl font-bold tracking-tight text-slate-800 sm:text-3xl">Articles</h1>
    <p class="mt-3 text-sm leading-7 text-slate-600 sm:text-base">
      新しい順で記事を表示しています。タグを選ぶとタグ別一覧に移動できます。
    </p>
    {tags.length > 0 && (
      <TagChips
        items={tags.map((tag) => ({
          label: tag.label,
          href: `/tags/${tag.slug}/`,
          count: tag.count,
        }))}
        className="mt-4"
      />
    )}
  </section>

  <section class="mt-6 space-y-4">
    {articles.map((article) => <ArticleCard article={article} />)}
    {
      articles.length === 0 && (
        <p class="panel p-5 text-sm text-slate-600">公開中の記事はまだありません。</p>
      )
    }
  </section>
</BaseLayout>
