<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Redirect | Natsu-B</title>
  <link rel="stylesheet" href="../assets/style.css" />
</head>
<body>
  <header>
    <nav>
      <a href="../">home</a>
      <a href="../profile/">profile</a>
      <a href="../redirect/">redirect</a>
      <a href="../sechack_demo/">sechack_demo</a>
      <a href="../sechack_rpi4_demo/">sechack_rpi4_demo</a>
    </nav>
  </header>

  <main>
    <h1>Redirect</h1>
    <p class="small">
      使い方: <code>/redirect/?to=https%3A%2F%2Fexample.com</code>
    </p>

    <div class="card" id="box">
      <p>転送先が指定されていません。以下から選ぶか、<code>?to=</code> を付けてください。</p>
      <ul>
        <li><a href="./?to=https%3A%2F%2Fgithub.com%2FNatsu-B">example: GitHub</a></li>
      </ul>
    </div>
  </main>

  <script>
    const params = new URLSearchParams(location.search);
    const to = params.get("to");
    if (to) {
      try {
        const u = new URL(to);
        if (u.protocol !== "https:") throw new Error("only https allowed");
        const box = document.getElementById("box");
        box.innerHTML = `
          <p>転送します…</p>
          <p><a href="${u.href}">${u.href}</a></p>
          <p class="small">自動で飛ばない場合はリンクをクリックしてください。</p>
        `;
        setTimeout(() => location.replace(u.href), 300);
      } catch (e) {
        const box = document.getElementById("box");
        box.innerHTML = `<p>不正なURLです: <code>${String(to).replaceAll("<","&lt;")}</code></p>`;
      }
    }
  </script>
</body>
</html>
